<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Blog</title>

  <!-- SEO -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Blog posts and writings">
  <link rel="canonical" href="/blog.html">

  <!-- Styles -->
  <style>
    body{
      margin:0;
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,sans-serif;
      background:#0f1115;
      color:#e6e6e6;
      line-height:1.6;
    }

    header{
      padding:2rem 1rem 1rem;
      text-align:center;
      border-bottom:1px solid #222;
    }

    h1{
      margin:0;
      font-weight:600;
      letter-spacing:.5px;
    }

    #search{
      margin-top:1.2rem;
      width:min(500px,90%);
      padding:.7rem .9rem;
      border-radius:10px;
      border:1px solid #333;
      background:#151922;
      color:#fff;
      font-size:1rem;
      outline:none;
    }

    #search:focus{
      border-color:#4da3ff;
      box-shadow:0 0 0 1px #4da3ff33;
    }

    main{
      max-width:900px;
      margin:auto;
      padding:1.5rem;
    }

    .post{
      padding:1.4rem;
      margin-bottom:1.2rem;
      border-radius:14px;
      background:#151922;
      border:1px solid #222;
      transition:.15s ease;
    }

    .post:hover{
      transform:translateY(-2px);
      border-color:#333;
    }

    .post h2{
      margin:.2rem 0 .4rem;
      font-size:1.4rem;
    }

    .post a{
      text-decoration:none;
      color:#6cb6ff;
    }

    .post a:hover{
      text-decoration:underline;
    }

    .preview{
      opacity:.85;
      margin:.5rem 0 .7rem;
    }

    .tags{
      font-size:.8rem;
      opacity:.6;
    }

    .empty{
      text-align:center;
      opacity:.5;
      margin-top:3rem;
      font-size:1.1rem;
    }

    footer{
      text-align:center;
      padding:2rem 1rem;
      opacity:.5;
      font-size:.85rem;
    }
  </style>
</head>

<body>

<header>
  <h1>Blog</h1>
  <input id="search" type="text" placeholder="Search posts...">
</header>

<main id="posts">
  <div class="empty">Loading posts...</div>
</main>

<footer>
  Updated automatically • Powered by GitHub Pages
</footer>

<script>
let POSTS = [];
const container = document.getElementById("posts");
const searchBox = document.getElementById("search");

/* ---------- render ---------- */

function render(list){

  if(!list.length){
    container.innerHTML =
      `<div class="empty">No posts found</div>`;
    return;
  }

  container.innerHTML = "";

  const frag = document.createDocumentFragment();

  list.forEach(post=>{
    const el = document.createElement("article");
    el.className = "post";

    el.innerHTML = `
      <h2>
        <a href="/blog/${post.slug}">
          ${post.title}
        </a>
      </h2>

      <div class="preview">
        ${post.preview}…
      </div>

      <div class="tags">
        ${post.tags.join(" • ")}
      </div>
    `;

    frag.appendChild(el);
  });

  container.appendChild(frag);
}

/* ---------- load index ---------- */

fetch("/assets/search-index.json")
  .then(r=>r.json())
  .then(data=>{
    POSTS = data;
    render(POSTS);
  })
  .catch(()=>{
    container.innerHTML =
      `<div class="empty">Failed to load posts</div>`;
  });

/* ---------- live search ---------- */

searchBox.addEventListener("input", e=>{
  const q = e.target.value.toLowerCase().trim();

  if(!q){
    render(POSTS);
    return;
  }

  const filtered = POSTS.filter(p =>
    p.title.toLowerCase().includes(q) ||
    p.preview.toLowerCase().includes(q) ||
    p.tags.join(" ").toLowerCase().includes(q)
  );

  render(filtered);
});
</script>

</body>
</html>
